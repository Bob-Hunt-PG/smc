


	<link href="include/specialpricing.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="Include/ajaxsync.js"></script>
	<script type="text/javascript" src="Include/NexJob.js"></script>
	<script type="text/javascript" src="Include/LoginControl.js"></script>
  
<SCRIPT language="JavaScript">

function stopRKey(evt) {
  var evt = (evt) ? evt : ((event) ? event : null);
  var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null);
  if ((evt.keyCode == 13) && (node.type!="textarea"))  {return false;}
}
document.onkeypress = stopRKey;


var blnOrder = false;
var blnFormAlreadySubmited = false;

function selectSeeds(cboCur)
{
//<!--SEEDS-->
    if (document.getElementById('hidSeedListId'))document.getElementById('hidSeedListId').value = cboCur.value;
    getListInfo(cboCur.value, '1', true);
//<!--/SEEDS-->
}

function getSeedList(strListId)
{
//<!--Write-->
    var objXML = null;

    objXML = AjaxGet('AJAXOrder.asp?what=seedlist&list=' + strListId, null, false, objXML);

    if (objXML != null)
    {
        document.getElementById('spnseedlist').innerHTML = objXML.responseText;
    }
//<!--/Write-->
}

//<!--MULTIDROP-->
var intMDMaxDrops = {mdmaxdrops};
var intMDMaxQtyPerDrop = {mdmaxqtyperdrop};
var intMDMinQtyPerDrop = {mdminqtyperdrop};
var intMDMaxDaysBetween = {mdmaxdaysbetween};
var intMDMinDaysBetween = {mdmindaysbetween};
var intMDMinDaySeq = '{mdmindayseq}';


function checkdropqty(intIndex)
{
    var intDropCount = 0;
    var intTotalQtyReq  = 0;
    var intCurQty = 0;
    var intTotalQty = 0;
    var intMinCount = 1;
    var strTotalText = '';
    var strMinErrorText = '';
    var strMaxErrorText = '';
    var blnOK = true;
    
    if (document.getElementById('hidlistcountseed'))
    {
        intMinCount = parseInt(document.getElementById('hidlistcountseed').value);
        if (intMinCount < 1)intMinCount = 1;
    }
    
    if (document.getElementById('dropqty' + intIndex))
    {
        if (!isNaN(parseInt(document.getElementById('dropqty' + intIndex).value)))
        {
            if (parseInt(document.getElementById('dropqty' + intIndex).value) < 0)document.getElementById('dropqty' + intIndex).value = intMinCount;
        }
        else
        {
            document.getElementById('dropqty' + intIndex).value = intMinCount;
        }
    }

    if (intMinCount < intMDMinQtyPerDrop)intMinCount=intMDMinQtyPerDrop;

    if (document.getElementById('dropcount'))
    {
        if (document.getElementById('dropcount').value != '')intDropCount = parseInt(document.getElementById('dropcount').value);
    }
    
    if (document.getElementById('droptotalqty'))
    {
        if (document.getElementById('droptotalqty').value != '')intTotalQtyReq = parseInt(document.getElementById('droptotalqty').value);
    }
    
    
    for (var i=1; i<=intDropCount; i++)
    {
        intCurQty = 0;
        if (!isNaN(parseInt(document.getElementById('dropqty' + i).value)))
        {
            intCurQty = parseInt(document.getElementById('dropqty' + i).value);
            if (intCurQty < intMinCount)
            {
                if (strMinErrorText != '') strMinErrorText += ', ';
                strMinErrorText += i;
            }
            
            if ((intCurQty > intMDMaxQtyPerDrop) && (intMDMaxQtyPerDrop > 0))
            {
                if (strMaxErrorText != '') strMaxErrorText += ', ';
                strMaxErrorText += i;
            }
            
            intTotalQty += parseInt(document.getElementById('dropqty' + i).value);
        }
        if ((intCurQty + '') != document.getElementById('dropqty' + i).value)document.getElementById('dropqty' + i).value = intCurQty + '';
    }
    
    strMinErrorText = setMaxMinDropText(strMinErrorText, intMinCount, true);
    strMaxErrorText = setMaxMinDropText(strMaxErrorText, intMDMaxQtyPerDrop, false);

    strTotalText = '<p>Total Required from ' + intDropCount + ' drops: ' + intTotalQtyReq;
    
    if ((intTotalQtyReq != intTotalQty) || (strMinErrorText + strMaxErrorText) != '')
    {
        strTotalText += '<ul><font color="#ff0000">';
        blnOK = false;
        if (intTotalQtyReq != intTotalQty)
        {
            strTotalText += '<li>You have entered ' + Math.abs(intTotalQty - intTotalQtyReq) + ' records too ';
            if ((intTotalQty - intTotalQtyReq) > 0){strTotalText += ' many'}else{strTotalText += ' few'}
            strTotalText += '</li>';
        }
        
        strTotalText += strMinErrorText + strMaxErrorText + '</font></ul>'
    }    
    strTotalText += '</p>';
    
    if (document.getElementById('spnTotalDropText'))document.getElementById('spnTotalDropText').innerHTML = strTotalText;
    
    return(blnOK);
}

function setMaxMinDropText(strText, intCount, blnMin)
{
    if (strText != '')
    {
        var intPos = strText.lastIndexOf(',');
        var strLeastMost = 'Maximum ';
        
        if (blnMin)strLeastMost = 'Minimum ';
        
        if (intPos > -1)
        {
            strText = 'drops ' + strText.substr(0,intPos) + ' and ' + strText.substr(intPos + 1);
        }
        else
        {
            strText = 'drop ' + strText;
        }
        
        strText = '<li>' + strLeastMost + ' value allowed for ' + strText + ' is ' + intCount + '</li>';
    }
    
    return(strText);
}


function getMultiDropAndSeedComboCount(intDropCount)
{
    var lngListCount = 0;
    var lngSeedCount = 0;

    if (document.getElementById('hidlistcount'))lngListCount=parseFloat(document.getElementById('hidlistcount').value);
    if (document.getElementById('hidlistcountseed'))lngSeedCount=parseFloat(document.getElementById('hidlistcountseed').value);
    
    return (lngListCount + (lngSeedCount * intDropCount));
}


function addDrop()
{
    var intDropCount = 0;
    var strDrops = '';
    var lngSeedCount = 0;
    var lngMinCount = 0;
    
    if (document.getElementById('tabDropTypes'))
    {
        if (document.getElementById('dropcount'))
        {
            if (document.getElementById('hidlistcountseed'))lngSeedCount=parseFloat(document.getElementById('hidlistcountseed').value);
            if (document.getElementById('dropcount').value != '')intDropCount = parseInt(document.getElementById('dropcount').value);
            
            if ((intMDMaxDrops > 0) && (intDropCount >= intMDMaxDrops))
            {
                alert('{JSMaxDropsCaption}' + intMDMaxDrops);
                return false;
            }
            
            
            for (var i=1; i<=intDropCount; i++)
            {
                if (i > 1)strDrops += ',';
                strDrops += document.getElementById('dropqty' + i).value;
            }
            intDropCount ++;
            
            if (intMDMinQtyPerDrop > lngSeedCount){lngMinCount = intMDMinQtyPerDrop}else{lngMinCount=lngSeedCount}
            
            var objXML = AjaxGet('AJAXOrder.asp?what=adddrops&temp={TemplateId}&btemp={BTemplateId}&index=' + intDropCount + '&seedcount=' + lngSeedCount + '&mincount=' + lngMinCount + '&mindays=' + intMDMinDaysBetween + '&maxdays=' + intMDMaxDaysBetween, null, false, objXML);
            
            document.getElementById('tabDropTypes').innerHTML += objXML.responseText;
            document.getElementById('dropcount').value = intDropCount;
            document.getElementById('droptotalqty').value=getMultiDropAndSeedComboCount(intDropCount);
            
            var aryQtys = strDrops.split(',');
            
            for (var i=0; i<aryQtys.length; i++)
            {
                strDrops += document.getElementById('dropqty' + (i+1)).value = aryQtys[i];
            }
            
            checkdropqty();
        }
        
    }
}

function removeDrop()
{
    var intDropCount = 0;
    
    if (document.getElementById('dropcount').value != '')
    {
        if (document.getElementById('dropcount').value != '0')
        {
            intDropCount = parseInt(document.getElementById('dropcount').value);
            
            document.getElementById('divdrop' + intDropCount).innerHTML = '';
            document.getElementById('divdrop' + intDropCount).style.display='none';
            document.getElementById('divdrop' + intDropCount).id = '';
            intDropCount-=1;
            document.getElementById('dropcount').value = intDropCount;
            document.getElementById('droptotalqty').value=getMultiDropAndSeedComboCount(intDropCount);
            
            checkdropqty();
        }
    }
}

//<!--/MULTIDROP-->

function getCountAndDrops(blnNew)
{

    var objXML = null;
    var strLists = '';
    var strURL = '';

//<!--MULTIDROP-->

    if (document.getElementById('hidSeedListId'))strLists = '&seedlist=' + document.getElementById('hidSeedListId').value;
    if (document.getElementById('hidListId'))strLists += '&list=' + document.getElementById('hidListId').value;

    if (strLists != '')
    {
        strURL = 'AJAXOrder.asp?what=getdrops' + strLists + '&temp={TemplateId}&btemp={BTemplateId}&ro={readonly}&order={Order}';
        if (blnNew)strURL += '&new=1';
        
        objXML = AjaxGet(strURL, null, false, objXML);

        if (objXML != null)
        {
            if (document.getElementById('tdmultidrop'))
            {
                document.getElementById('tdmultidrop').innerHTML = objXML.responseText;
                if (document.getElementById('dropcount'))
                {
                    if (document.getElementById('dropcount').value != '')
                    {
                        if (document.getElementById('divaddremdrops'))document.getElementById('divaddremdrops').style.display = '';
                    }
                 }
            }
        }
//<!--Write-->
        if (document.getElementById('droptotalqty'))
        {
        	    document.getElementById("spnQuantity").innerHTML = document.getElementById('droptotalqty').value;
				setTotalQuantity(document.getElementById('droptotalqty').value);
        }
//<!--/Write-->

        if (document.getElementById('tabMultiDrop'))document.getElementById('tabMultiDrop').style.display = '';
        
   }
   else
   {
    if (document.getElementById('tabMultiDrop'))document.getElementById('tabMultiDrop').style.display = 'none';
   }  
   
//<!--/MULTIDROP-->  

//<!--Write-->
        if (!(document.getElementById('droptotalqty')))
        {
            if (document.getElementById('hidSeedListId'))strLists = '&list=' + document.getElementById('hidSeedListId').value;
            if (document.getElementById('hidListId'))strLists += '&list=' + document.getElementById('hidListId').value;

            objXML = AjaxGet('AJAXOrder.asp?what=listcount' + strLists, null, false, objXML);
            if (objXML != null)
            {
                document.getElementById("spnQuantity").innerHTML = objXML.responseText;
                setTotalQuantity(objXML.responseText);
            }
        }
//<!--/Write-->

}

function setTotalQuantity(lngTQ)
{
    for (var i=1; i<=document.getElementsByName('TotalQuantity').length; i++)
    {
        document.getElementsByName('TotalQuantity')[i-1].value = lngTQ;
    }
}

function getListInfo(strListId, strSeed, blnNew)
{

//<!--LIST-->

    var strSeedURL = '';
    var strLists = '';
    var objXML = null;
    var strListMappings = '{mappings}';
    var strSeedMappings = '{seedmappings}';
    var strMappings = '';
    
    
    if (document.getElementById('tabRules'))document.getElementById('tabRules').style.display = '';
    
    if (strSeed)
    {
        if (strSeed != '')strSeedURL = '&seed=1';
    }
    
    if (strSeedURL != ''){strSeed = 'Seed'}else{strSeed = ''}
	if (strListId == undefined)strListId = '';
	
    if (strListId != '')
    {
        if (strSeed != ''){strMappings = strSeedMappings}else{strMappings = strListMappings}
        document.getElementById('spn' + strSeed + 'ListMappings').innerHTML = '<img src="images/process.gif" width="20">';
        
        populateStationeryPH(AjaxGet('StationeryListMappings.aspx?{opssess}&ro={readonly}&stat={StatId}&list=' + strListId + '&mappings=' + strMappings + '&order={Order}' + strSeedURL, null, false, objXML), strSeed);
		if (document.getElementById('btnCompose'))document.getElementById('btnCompose').style.display='';
    }
    else
    {
        if (strSeed == '')document.getElementById('spn' + strSeed + 'ListName').innerHTML = 'No Selection';
	    document.getElementById('spn' + strSeed + 'ListMappings').innerHTML = '';
    }
    
    getCountAndDrops(blnNew);
    
//<!--Write-->
    getPrice();
//<!--/Write-->    
    
//<!--/LIST-->
}

function setDate(strName, strDate, strNextDate, strIndex, blnOK)
{   
    
    document.getElementById('spn' + strName).innerHTML = strDate;
    document.getElementById(strName).value = strDate;
    hs.close();
    
    if ((strNextDate != '') && (blnOK == false))
    {
        if (document.getElementById(strNextDate).value != '')
        {
            if (strIndex != '')alert('{JSSelectNewDropDateCaption} ' + (parseInt(strIndex) + 1));
            document.getElementById('spn' + strNextDate).innerHTML = '';
            document.getElementById(strNextDate).value = '';
        }
    }
    
    //document.getElementById(strName).focus();
}

function getListPrice(xmlHttp)
{
    var aryCountCost;
    
    if (xmlHttp != null)
    {
	
	    if (xmlHttp.readyState==4)
	    {   
	        aryCountCost = xmlHttp.responseText.split('|');
	        if (aryCountCost.length > 1)
	        {
				if(aryCountCost[0]=='')aryCountCost[0] = '0';
	            document.getElementById("spnQuantity").innerHTML = aryCountCost[0];
				if (aryCountCost[0] !=null)setTotalQuantity(aryCountCost[0]);
	            if (document.getElementById('theCost'))document.getElementById('theCost').innerHTML = '{CurrencySymbol} ' + aryCountCost[1];
	        }
	    }
	}
}

function getList(strListId, strListName, strListPrice, strSeed)
{
//<!--Write-->
    var blnFoundSeed = false;
    
    if (strSeed != '')strSeed = 'Seed';
    
    document.getElementById('hid' + strSeed + 'ListId').value = strListId;
    
    if (strSeed == '')
    {
        blnFoundSeed = true;
        document.getElementById('spn' + strSeed + 'ListName').innerHTML = strListName;
    }
    else
    {
        if (document.getElementById('cboSeeds'))
        {
            for (var i=0; i < document.getElementById('cboSeeds').options.length; i++)
            {
                if (document.getElementById('cboSeeds').options[i].value == strListId)
                {
                    document.getElementById('cboSeeds').selectedIndex = i;
                    blnFoundSeed = true;
                    break;
                }
            }
        }
    }
    
    
	if((strListPrice!='') && (strSeed == ''))
	{
		if(strListPrice!='0')
		{
			strListPrice = parseFloat(strListPrice);
			document.getElementById('spnPurchasePrice').innerHTML = '{JSListPurchasePriceCaption} {CurrencySymbol} ' + strListPrice.toFixed(2);
		}
	}
	
	if (! blnFoundSeed)getSeedList(strListId)
    getListInfo(strListId, strSeed, true);
    hs.close();

//<!--/Write-->
}


function getPrice()
{
//<!--Write-->
    var objXML = null;
    var strLists = '';

    if (document.getElementById('spnQuantity'))
    {

        if((document.getElementById('hidSeedListId')) || (document.getElementById('hidListId')))
        {
            if (document.getElementById('hidSeedListId'))
            {
                if (document.getElementById('hidSeedListId').value != '')strLists = '&list=' + document.getElementById('hidSeedListId').value;
            }
            if (document.getElementById('hidListId').value != '')strLists += '&list=' + document.getElementById('hidListId').value;
            
            if (strLists == '')
            {
                document.getElementById('spnQuantity').innerHTML = '0';
                if (document.getElementById('theCost'))document.getElementById('theCost').innerHTML = '';
            }
            else
            {
                if (document.getElementById('theCost'))document.getElementById('theCost').innerHTML = '<img src="images/process.gif" width="20">';
                getListPrice(AjaxGet('AJAXOrder.asp?what=listcountcost' + strLists + '&qty=' + document.getElementById('TotalQuantity').value + '&temp={TemplateId}', null, false, objXML));
                
            }
   	    }
    }
//<!--/Write-->
}

function download(objThis, strWhat, strVP, strOrder)
{

  var strList = '';
  if (document.getElementById('hidListId'))strList = document.getElementById('hidListId').value;
  
  if ((document.getElementById('divdownloadlist')) && (strList != ''))document.getElementById('divdownloadlist').style.display='';
  if (strWhat == '')
  {
    objThis.href = 'DownloadProduct.asp?sid={StatId}&tid={TemplateId}&pid={PID}';
    hs.htmlExpand(objThis, {contentId: 'divdownload', outlineType: 'rounded-white', preserveContent: true, width: 300, height: 200 })
  }
  else
  {
    window.location = 'DownloadProduct.asp?download' + strWhat + '=1&sid={StatId}&pid={PID}&tid={TemplateId}&list=' + strList + '&order=' + strOrder + '&vp=' + strVP;
  }
  
}

function getRules()
{       
	document.getElementById("hsRules").href = 'VWebRules.aspx?list=' + document.getElementById('hidListId').value + '&statid={StatId}&cpid={PID}&theorder=' + document.getElementById('torder').value + '&order={Order}&{opssess}';
	hs.htmlExpand(document.getElementById("hsRules"), {objectType: 'iframe', outlineType: 'rounded-white', wrapperClassName: 'highslide-wrapper', outlineWhileAnimating: true, preserveContent: false, width: 780 } )
}

function closeRules(lngTempOrder, strRules)
{

  if (parent.document.getElementById('torder'))parent.document.getElementById('torder').value=lngTempOrder;
  if (parent.document.getElementById('torder2'))parent.document.getElementById('torder2').value=lngTempOrder;
  if (parent.document.getElementById('torder3'))parent.document.getElementById('torder3').value=lngTempOrder;
  
  document.getElementById('tdRules').innerHTML = strRules;
  parent.hs.close()
}

function populateStationeryPH(xmlHttp, strSeed) 
{ 
    var strLists = '';
    var strMappings = '';
    var objXML = null;
    
    if (xmlHttp != null)
    {
	    if (xmlHttp.readyState==4)
	    {
	        strMappings = xmlHttp.responseText;
	        if (strMappings != '')
			{	 
			 
<!--nodownloadonly-->
<!--Write-->
				if (document.getElementById('tabRules'))document.getElementById('tabRules').style.display = '';
<!--/Write-->
<!--/nodownloadonly-->
				document.getElementById('tabproof').style.display = '';
			}
			else
			{
				document.getElementById('tabproof').style.display = 'none';
			}
			
	        document.getElementById('spn' + strSeed + 'ListMappings').innerHTML = strMappings;
			checkListProcessingRequired();
	    }
	}
}

function checkListProcessingRequired()
{
	if(document.getElementById('hidliststatus') && document.getElementById('btnProcessList'))
	{
		if((document.getElementById('hidliststatus').value == "Processed") || (document.getElementById('hidliststatus').value == "Awaiting Purchase"))
		{
			ToggleOrderButtons(true, false);
			document.getElementById('btnProcessList').style.display='none';
		} else {
			ToggleOrderButtons(false, false);
			document.getElementById('btnProcessList').style.display='';
		}
	}
}

function showVariableProof()
{
    var i=1;
    var strMappings = '';
    var strListId = '{listid}';
    var strSeedListId = '{seedlistid}';
    var strOrder = '{Order}';
	var strURL = '';
	
	if (document.getElementById('torder').value != '')strOrder = document.getElementById('torder').value;
    if (document.getElementById('hidListId').value != '')strListId = document.getElementById('hidListId').value;
    
    if (document.getElementById('cboSeeds'))strSeedListId = document.getElementById('cboSeeds').value;
    
    strMappings = getMappings('');
    if (strMappings != '')strURL = '&list=' + strListId 
    
    if (strSeedListId != '')
    {
        strMappings = getMappings('seed');
        if (strMappings != '')strURL += '&list=' + strSeedListId 
    }
    document.getElementById('mappings').value = strMappings;
    if (strURL != '')openWinVPrint('VWebProofArtwork.asp?order=' + strOrder + '&nav=true&currec=first&type=print&stat={StatId}&temp={TemplateId}&btemp={BTemplateId}' + strURL);
}

function getMappings(strSeed)
{

   var strMappings = '';
   
   if (document.getElementById('hid' + strSeed + 'phcount'))
    {
    
        for (i=0; i<parseInt(document.getElementById('hid' + strSeed + 'phcount').value); i++)
        {
            if (strMappings != '')strMappings += '|';
            strMappings += document.getElementById('hid' + strSeed + 'ph-' + i).value;
    	    strMappings += '|' + document.getElementById('select' + strSeed + 'ph-' + i).value + '|';
        }           
    } 
    
   return(strMappings); 
}

function openWinVPrint(strURL)
{
	document.getElementById('frm2').action = strURL;
	open ('', 'VPrintProof','width=600,height=600,toolbar=0,status=0,location=0,menubar=0,scrollbars=1,resizable=1');
	document.getElementById('frm2').target = 'VPrintProof';
	document.getElementById('frm2').submit();    
	document.getElementById('frm2').focus();
}

function ShowPrice(chkCur)
{

<!--Cost-->
    var strCost = "{Cost}";
    var strCostCap = "{CostCaption}";
    var strUrgentCost = "{UrgentCost}";
    var strUrgentCaption = "{CostCaption}";
    var blnUrgent = false
    
    if (document.getElementById('deliveryoptions'))
    {
        var strSelOp = document.getElementById('deliveryoptions').value;
        if (strSelOp != "")
        {
            if (strSelOp.charAt(0) == "1")blnUrgent = true;
        }
    }
    else
    {    
	    if (chkCur.checked)blnUrgent = true;
    }

    if (! blnUrgent)
    {
        document.getElementById('theCost').innerHTML = strCost;
        document.getElementById('theCostText').innerHTML = strCostCap;

    }
    else
    {
        document.getElementById('theCost').innerHTML = strUrgentCost;
        document.getElementById('theCostText').innerHTML = strUrgentCaption;
    }
    
<!--/Cost-->
}

function checkOrder()
{
	if (typeof AdditionalOrderCheck =="function")
	{
		if(!AdditionalOrderCheck())
		{
			return false;
		}
	}
	
	if (!hasApproverEmail()) return false;

		
	if (blnOrder)
	{
		//   <!--PONumberCheck-->
		alert('{JSEnterPONumberCaption}');
		return false;
		//   <!--/PONumberCheck-->
        	
        if (! checkAllDropDates())return(false);
        
		return confirm("{JSOrderNowCaption}");
	}
}

function hasApproverEmail()
{
	var blnCheckEmail = false;
	var strEmail = '';

	if(document.getElementById('preapproval') != null)
	{
		blnCheckEmail = true;
		strEmail = document.getElementById('preapproval').value;
	}

	if(document.getElementById('preapprovalselect') != null)
	{
		blnCheckEmail = true;
		if (document.getElementById('preapprovalselect').value.length > 0)
		{
			if (document.getElementById('preapprovalselect').value.charAt(0) != '@')strEmail = '';
		}

		strEmail += document.getElementById('preapprovalselect').value;

	}

	if(blnCheckEmail)
	{


		if (! isEmail(strEmail, false))
		{
			alert('{JSMissingApproverEmailCaption}');
			return false
		}
		
	}
	return true;

}

function CheckApproverEmail()
{

<!--PreApprovalJava-->
	var strValue = '';
	var strDisplay = '';

<!--PreApprovalSelect-->
	strValue = document.getElementById('preapprovalselect').value;
<!--/PreApprovalSelect-->

	if (strValue.length > 0)
	{
		if (strValue.charAt(0) != '@')strDisplay = 'none'
	}

	if(document.getElementById('preapproval') != null)document.getElementById('preapproval').style.display = strDisplay;
<!--/PreApprovalJava-->

}


function isEmail (s)
{   if (isWhitespace(s)) 
       if (isEmail.arguments.length == 1) return false;
       else return (isEmail.arguments[1] == true);
   
    if (isWhitespace(s)) return false;

    var i = 1;
    var sLength = s.length;
    
    while ((i < sLength) && (s.charAt(i) != "@")) {i++}

    if ((i >= sLength) || (s.charAt(i) != "@")) return false;
    else i += 2;

    // look for .
    while ((i < sLength) && (s.charAt(i) != "."))
    { i++
    }
    if ((i >= sLength - 1) || (s.charAt(i) != ".")) return false;
    else return true;
}



function isWhitespace (strCurrent)

{   var i;
	var whitespace = " \t\n\r";
	
    if (isEmpty(strCurrent)) return true;

    for (i = 0; i < strCurrent.length; i++)
    {   
        var c = strCurrent.charAt(i);

        if (whitespace.indexOf(c) == -1) return false;
    }
    
    return true;
}

function isEmpty(strCurrent)
{  
	return ((strCurrent == null) || (strCurrent.length == 0))
}

function CheckApproveArtwork() {
	var blnResult=false;
	var strValue='';

    if (! checkAllDropDates())return(false);
    
	if(document.getElementById('chkartworkapprove')) {
		if(document.getElementById('chkartworkapprove').checked) {
		
		} else {
			alert('{JSCheckApprovalBoxCaption}');
			return false;
		}
	}
	if(document.getElementById('NJV')) {
		if(document.getElementById('NJV').type != "hidden")
		{
			strValue=document.getElementById('NJV').value;
			blnResult=IsValid('int', strValue);
			if(strValue=='0') blnResult=false;
			if(blnResult==false)
			{
				alert('{JSInvalidQuantityCaption}');
				return false;
			}
		}
	}
}

function checkAllDropDates()
{


    var blnOK = true;
//<!--MULTIDROP-->

	if (document.getElementById('dropcount'))
	{
	    if (document.getElementById('dropcount').value != '')
	    {
	        for (var i=1; i <= parseInt(document.getElementById('dropcount').value); i++)
	        {
	            if(document.getElementById('txtDrop' + i).value == '')
	            {
	                alert('{JSNoDropDateCaption} ' + i);
	                blnOK = false;
	                break;
	            }
	        }
	    }
	    
	}
	
	if (blnOK)
	{
		blnOK = checkdropqty();
		if (!blnOK)alert('{JSIncorrectDropQtyCaption}');
	}
	
	if (blnOK)
	{
		if (document.getElementById('hidmddroperror'))
		{
			alert('{JSIncorrectDropRulesCaption}');
			blnOK = false;
		}
	}
	
//<!--/MULTIDROP-->
	
	return(blnOK);
}

function UpdateComment(ddlComments)
{
  document.getElementById('precomments').value = ddlComments.options[ddlComments.selectedIndex].value;
}


function CheckEntry(strControlName, strCaption, intMaxLen, blnRequired)
{

	var s = document.getElementById(strControlName).value;
	
	if (blnRequired)
	{
		if (isWhitespace(s)) {return alert('{JSDataRequiredCaption}:\n' + strCaption)}
	}
	if (intMaxLen < s.length)
	{
		return alert('{JSDataTooLongCaption}, ' + intMaxLen + ' {JSMaximumCaption}:\n' + strCaption);
	}
		
	return(true);
}
function isWhitespace (strCurrent)

{   var i;
	var whitespace = " \t\n\r";
	
    if (isEmpty(strCurrent)) return true;

    for (i = 0; i < strCurrent.length; i++)
    {   
        var c = strCurrent.charAt(i);

        if (whitespace.indexOf(c) == -1) return false;
    }
    
    return true;
}

function isEmpty(strCurrent)
{  
	return ((strCurrent == null) || (strCurrent.length == 0))
}


function check_data()
{	 if (! CheckEntry('Address1', '{Address1Caption}', 80, true))return(false);
	 if (! CheckEntry('Address2', '{Address2Caption}', 80, false))return(false);
     if (! CheckEntry('Suburb', '{SuburbCaption}', 50, true))return(false);
     if (! CheckEntry('State', '{StateCaption}', 50, false))return(false);
     if (! CheckEntry('PostCode', '{PostcodeCaption}', 15, false))return(false);
}



function updateme(strWhat, strType)
{
	var strValue="";

	switch(strType)
	{
	case 'textbox':
		strValue = document.getElementById("Entry" + strWhat).value;
		break;
	case 'dropdown':
		strValue=document.getElementById("Entry" + strWhat).options[document.getElementById("Entry" + strWhat).selectedIndex].value;
		break;
	default:
		strValue = document.getElementById("Entry" + strWhat).value;
	}
	document.getElementById(strWhat).value=strValue;

	copyAd();
}

function LoadAddresses()
{
	var myindex;
	var SelValue;
	var objXML;
	if (document.getElementById('countrylist'))
	{
		myindex  = document.getElementById('countrylist').selectedIndex;
		SelValue = document.getElementById('countrylist').options[myindex].value;
		document.getElementById('Country').value = SelValue;
		
		CountryAllAddressLoad(AjaxGet("GetHTMLAJAX.asp?Country=" + document.getElementById('countrylist').options[myindex].text, null, false, objXML));
	}
}

function CountryChanged()
{
	var objXML;
    var myindex  = document.getElementById('countrylist').selectedIndex
    var SelValue = document.getElementById('countrylist').options[myindex].value

	document.getElementById('Country').value = SelValue;
	CountryAddressLoad(AjaxGet("GetHTMLAJAX.asp?Country=" + document.getElementById('countrylist').options[myindex].text, null, false, objXML));

}

function CountryAllAddressLoad(xmlHttp)
{
	var strResult;
	var aryHTMLs = new Array();

	if (xmlHttp.readyState==4)
	{
		if(xmlHttp.responseText == "")
		{

		} else {
			strResult = xmlHttp.responseText;
			aryHTMLs = strResult.split('|Billing|');
			if(aryHTMLs[0] != undefined){document.getElementById("deladr").innerHTML = aryHTMLs[0];}
			copyAd();
			
		}
	}	
}

function CountryAddressLoad(xmlHttp)
{
	var strResult;
	var aryHTMLs = new Array();

	if (xmlHttp.readyState==4)
	{
		if(xmlHttp.responseText == "")
		{

		} else {
		
			strResult = xmlHttp.responseText;
			aryHTMLs = strResult.split('|Billing|');
			if(aryHTMLs[0] != undefined){document.getElementById("deladr").innerHTML = aryHTMLs[0];}
		}

		copyAd();
	}	

}

function copyAd()
{
    if (document.getElementById('EntryAddress1')){document.getElementById('EntryAddress1').value = document.getElementById('Address1').value}
	if (document.getElementById('EntryAddress2')){document.getElementById('EntryAddress2').value = document.getElementById('Address2').value}
	if (document.getElementById('EntrySuburb')){document.getElementById('EntrySuburb').value = document.getElementById('Suburb').value}
	if (document.getElementById('EntryState')){document.getElementById('EntryState').value = document.getElementById('State').value}
	if (document.getElementById('EntryPostCode')){document.getElementById('EntryPostCode').value = document.getElementById('PostCode').value}
	
    document.getElementById('Address1').value = getElementValue('EntryAddress1');
	document.getElementById('Address2').value = getElementValue('EntryAddress2');
	document.getElementById('Suburb').value = getElementValue('EntrySuburb');
	document.getElementById('State').value = getElementValue('EntryState');
	document.getElementById('PostCode').value = getElementValue('EntryPostCode');
	
}

function getElementValue(strName)
{
	if (document.getElementById(strName)){return document.getElementById(strName).value} else {return ''}
}

function hasAddress()
{
	return ValidFreeAddress();
}

function EditDelivery()
{
	//<!--SplitShippingValidation-->
	LoadAddresses();
	document.getElementById('divEditDelivery').style.display = "";
	document.getElementById('TrDeliveryAddress').style.display = "none";
	document.getElementById('TrButtonEditDelivery').style.display = "none";
	
	ToggleOrderButtons(false, true)
}

function ToggleOrderButtons(blnShow, blnRemoveSave)
{
	var strDisplay;
	
	if(blnShow) {
		strDisplay = "";
	} else {
		strDisplay = "none";
	}
	
	if (document.getElementById('btnDownload')){document.getElementById('btnDownload').style.display = strDisplay;}
	if (document.getElementById('btnVariable')){document.getElementById('btnVariable').style.display = strDisplay;}
	if (document.getElementById('btnCompose')){document.getElementById('btnCompose').style.display = strDisplay;}
	if(blnRemoveSave) {
		if (document.getElementById('btnSave')){document.getElementById('btnSave').style.display = strDisplay;}
	}
	if (document.getElementById('btnOrder')){document.getElementById('btnOrder').style.display = strDisplay;}
	if (document.getElementById('btnCart')){document.getElementById('btnCart').style.display = strDisplay;}
	if (document.getElementById('btnVWeb')){document.getElementById('btnVWeb').style.display = strDisplay;}
}

function CheckSaveIntegrity()
{
	//<!--SaveIntegrityValidation-->
	if (document.getElementById('TNJId'))
	{
		if ((document.getElementById('TNJId').value != '') && !(document.getElementById('TNJTotalQuantity')))
			{
				LoadNexJob();
				if (document.getElementById('chkartworkapprove'))
					{
						document.getElementById('chkartworkapprove').checked = false;
					}
				return false;
			}
	}
	if (blnFormAlreadySubmited || (CheckApproveArtwork()==false)) {
		return false;
	} else {
		blnFormAlreadySubmited = true;
		return true;
	}
}

</SCRIPT>


<!--OrderDetails-->
<!--PreApprover-->
<form method="post">
    <table class="table proofapproval">
        <tr><td class="bordertableheader">{ApprovalHeading} - {OrderNumber}</td></tr>
        <tr><td valign="center"><b>{CommentsCaption}:</b><br>{CommentReasons}<textarea cols=43 rows=4 name=precomments id=precomments></textarea></td></tr>
        <tr><td align="center"><input type=submit name="btnApprove" value="{ButtonApproveCaption}">&nbsp;&nbsp;<input type=submit name="btnDecline" value="{ButtonDeclineCaption}"></td></tr>
    </table>
</form>
<!--/PreApprover-->
<!--Write-->
<form action="step3edit.asp?HT={HT}" method="Post" {formtarget} id=form4 name=form4>
    <input type="hidden" name="torder2" id="torder2" value="{torder}" />
    <table class="table proofwrite" id=proofScreenEditOrderDetails>
        <tr>
            <td colspan="2" align="left" class=bordertableheader>
                <!--HiddenVariables-->
                <!--HiddenEVariables-->
                <!--EditOrderDetailsButton--><input class="btn btn-primary" type="submit" value="{ButtonEditOrderDetailsCaption}"><!--/EditOrderDetailsButton-->&nbsp;
            </td>
        </tr>
    </table>
</form>
<!--/Write-->
<!--/OrderDetails-->
<!--Write-->
<form action="Order.asp" method="Post" {formtarget} id=form1 name=form1 onSubmit="return checkOrder();">
    <!--/Write-->
    <input type="hidden" name="torder" id="torder" value="{torder}" />
    <table class="table prooforderdetails" id=proofScreenOrderDetails>
        <!--CostCentre-->
        <tr>
            <td class="DescriptionText">Cost Center</td>
            <td class="DescriptionText">{CostCentre}</td>
        </tr>
        <!--/CostCentre-->
        <!--TemplateName-->
        <tr>
            <td class="DescriptionText">Product Name</td>
            <td class="DescriptionText">{TemplateName}</td>
        </tr>
        <!--/TemplateName-->
        <!--OrderDetails-->
        <tr>
            <td class="quantities-table" colspan="2"><b>Select Quantity</b></td>
        </tr>
        <!--ExtraInfos-->
        <tr>
          <td class="DescriptionText">{ExtraInfoCaption}</td>
          <td class="DescriptionText">{ExtraInfoField}</td>
        </tr>
        <!--/ExtraInfos-->
        <!--ExtraInfoGroup-->
        <tr>
            <td colspan=2>
                <div id="div{GroupName}">
                    <table width="100%" cellspacing="0" cellpadding="0" border="0">
                        <tr>
                            <td colspan="2" class=bordertableheader>{GroupName}</td>
                        </tr>
                        <!--ExtraInfosGroup-->
                        <tr>
                            <td width="120" class="TextBoxTextGroup">{ExtraInfoCaption}</td>
                            <td class="TextBoxText">{ExtraInfoField}</td>
                        </tr>
                        <!--/ExtraInfosGroup-->
                    </table>
                </div>
            </td>
        </tr>
        <!--/ExtraInfoGroup-->
        <!--Quantity-->
        <tr>
            <td class="DescriptionText">{QuantityCaption}</td>
            <td class="DescriptionText"><span id="spnQuantity">{NoBoxes}</span></td>
        </tr>
        <!--/Quantity-->
        <!--Cost-->
        <tr>
            <td class="DescriptionText"><span id="theCostText">{CostCaption}<!--{DisplayCostCaption}--></span></td>
            <td class="DescriptionText"><span id="theCost">{DisplayCost}</span></td>
        </tr>
        <!--/Cost-->
        <!--ItemOnHand-->
        <tr>
            <td class="DescriptionText"><span id="theLevelText">{StockCaption}</span></td>
            <td class="DescriptionText"><span id="theLevel">{ItemOnHand}</span></td>
        </tr>
        <!--/ItemOnHand-->
        <!--FreightType-->
        <tr id="TrFreightType">
            <td class="DescriptionText">{FreightTypeCaption}</td>
            <td class="DescriptionText">{FreightType}</td>
        </tr>
        <!--/FreightType-->
        <!--DeliveryAddress-->
        <tr id="TrDeliveryAddress">
            <td class="DescriptionText">{DeliveryAddressCaption} </td>
            <td class="DescriptionText">{DelAddress}</td>
        </tr>
        <!--/DeliveryAddress-->
        <!--EditDelivery-->
        <tr id="TrButtonEditDelivery">
            <td class="DescriptionText" colspan=2><input type="submit" value="{ButtonEditDeliveryCaption}" onClick="javascript:EditDelivery(); return false;"></td>
        </tr>
        <!--/EditDelivery-->
        <tr>
            <td colspan="2">
                <div id=divEditDelivery style="display:none">
                    <table class="bordertable" cellpadding="2" cellspacing="0">
                        <tr>
                            <td class="addresslabel" align="right">{CountryCaption}</td>
                            <td>
                                <select id=countrylist name=countrylist onchange='CountryChanged();'>
                					<option value="AF">Afghanistan</option>
                					<option value="AX">Aland Islands</option>
                					<option value="AL">Albania</option>
                					<option value="DZ">Algeria</option>
                					<option value="AS">American Samoa</option>
                					<option value="AD">Andorra</option>
                					<option value="AO">Angola</option>
                					<option value="AI">Anguilla</option>
                					<option value="AQ">Antarctica</option>
                					<option value="AG">Antigua and Barbuda</option>
                					<option value="AR">Argentina</option>
                					<option value="AM">Armenia</option>
                					<option value="AW">Aruba</option>
                					<option value="AU">Australia</option>
                					<option value="AT">Austria</option>
                					<option value="AZ">Azerbaijan</option>
                					<option value="BS">Bahamas</option>
                					<option value="BH">Bahrain</option>
                					<option value="BD">Bangladesh</option>
                					<option value="BB">Barbados</option>
                					<option value="BY">Belarus</option>
                					<option value="BE">Belgium</option>
                					<option value="BZ">Belize</option>
                					<option value="BJ">Benin</option>
                					<option value="BM">Bermuda</option>
                					<option value="BT">Bhutan</option>
                					<option value="BO">Bolivia</option>
                					<option value="BQ">Bonaire</option>
                					<option value="BA">Bosnia and Herzegovina</option>
                					<option value="BW">Botswana</option>
                					<option value="BV">Bouvet Island</option>
                					<option value="BR">Brazil</option>
                					<option value="IO">British Indian Ocean Territory</option>
                					<option value="BN">Brunei Darussalam</option>
                					<option value="BG">Bulgaria</option>
                					<option value="BF">Burkina Faso</option>
                					<option value="BI">Burundi</option>
                					<option value="KH">Cambodia</option>
                					<option value="CM">Cameroon</option>
                					<option value="CA">Canada</option>
                					<option value="CV">Cape Verde</option>
                					<option value="KY">Cayman Islands</option>
                					<option value="CF">Central African Republic</option>
                					<option value="TD">Chad</option>
                					<option value="CL">Chile</option>
                					<option value="CN">China</option>
                					<option value="CX">Christmas Island</option>
                					<option value="CC">Cocos (Keeling) Islands</option>
                					<option value="CO">Colombia</option>
                					<option value="KM">Comoros</option>
                					<option value="CG">Congo</option>
                					<option value="CK">Cook Islands</option>
                					<option value="CR">Costa Rica</option>
                					<option value="CI">Cote D'Ivoire (Ivory Coast)</option>
                					<option value="HR">Croatia (Hrvatska)</option>
                					<option value="CU">Cuba</option>
                					<option value="CW">Curacao</option>
                					<option value="CY">Cyprus</option>
                					<option value="CZ">Czech Republic</option>
                					<option value="CD">Democratic Republic of the Congo</option>
                					<option value="DK">Denmark</option>
                					<option value="DJ">Djibouti</option>
                					<option value="DM">Dominica</option>
                					<option value="DO">Dominican Republic</option>
                					<option value="TP">East Timor</option>
                					<option value="EC">Ecuador</option>
                					<option value="EG">Egypt</option>
                					<option value="SV">El Salvador</option>
                					<option value="GQ">Equatorial Guinea</option>
                					<option value="ER">Eritrea</option>
                					<option value="EE">Estonia</option>
                					<option value="ET">Ethiopia</option>
                					<option value="FK">Falkland Islands (Malvinas)</option>
                					<option value="FO">Faroe Islands</option>
                					<option value="FM">Federated States of Micronesia</option>
                					<option value="FJ">Fiji</option>
                					<option value="FI">Finland</option>
                					<option value="FR">France</option>
                					<option value="GF">French Guiana</option>
                					<option value="PF">French Polynesia</option>
                					<option value="TF">French Southern Territories</option>
                					<option value="GA">Gabon</option>
                					<option value="GM">Gambia</option>
                					<option value="GE">Georgia</option>
                					<option value="DE">Germany</option>
                					<option value="GH">Ghana</option>
                					<option value="GI">Gibraltar</option>
                					<option value="GB">Great Britain (UK)</option>
                					<option value="GR">Greece</option>
                					<option value="GL">Greenland</option>
                					<option value="GD">Grenada</option>
                					<option value="GP">Guadeloupe</option>
                					<option value="GU">Guam</option>
                					<option value="GT">Guatemala</option>
                					<option value="GN">Guinea</option>
                					<option value="GW">Guinea-Bissau</option>
                					<option value="GY">Guyana</option>
                					<option value="HT">Haiti</option>
                					<option value="HM">Heard Island and McDonald Islands</option>
                					<option value="HN">Honduras</option>
                					<option value="HK">Hong Kong</option>
                					<option value="HU">Hungary</option>
                					<option value="IS">Iceland</option>
                					<option value="IN">India</option>
                					<option value="ID">Indonesia</option>
                					<option value="IR">Iran</option>
                					<option value="IQ">Iraq</option>
                					<option value="IE">Ireland</option>
                					<option value="IL">Israel</option>
                					<option value="IT">Italy</option>
                					<option value="JM">Jamaica</option>
                					<option value="JP">Japan</option>
                					<option value="JO">Jordan</option>
                					<option value="KZ">Kazakhstan</option>
                					<option value="KE">Kenya</option>
                					<option value="KI">Kiribati</option>
                					<option value="KP">Korea (North)</option>
                					<option value="KR">Korea (South)</option>
                					<option value="KW">Kuwait</option>
                					<option value="KG">Kyrgyzstan</option>
                					<option value="LA">Laos</option>
                					<option value="LV">Latvia</option>
                					<option value="LB">Lebanon</option>
                					<option value="LS">Lesotho</option>
                					<option value="LR">Liberia</option>
                					<option value="LY">Libya</option>
                					<option value="LI">Liechtenstein</option>
                					<option value="LT">Lithuania</option>
                					<option value="LU">Luxembourg</option>
                					<option value="MO">Macao</option>
                					<option value="MK">Macedonia</option>
                					<option value="MG">Madagascar</option>
                					<option value="MW">Malawi</option>
                					<option value="MY">Malaysia</option>
                					<option value="MV">Maldives</option>
                					<option value="ML">Mali</option>
                					<option value="MT">Malta</option>
                					<option value="MH">Marshall Islands</option>
                					<option value="MQ">Martinique</option>
                					<option value="MR">Mauritania</option>
                					<option value="MU">Mauritius</option>
                					<option value="YT">Mayotte</option>
                					<option value="MX">Mexico</option>
                					<option value="MD">Moldova</option>
                					<option value="MC">Monaco</option>
                					<option value="MN">Mongolia</option>
                					<option value="MS">Montserrat</option>
                					<option value="MA">Morocco</option>
                					<option value="MZ">Mozambique</option>
                					<option value="MM">Myanmar</option>
                					<option value="NA">Namibia</option>
                					<option value="NR">Nauru</option>
                					<option value="NP">Nepal</option>
                					<option value="NL">Netherlands</option>
                					<option value="AN">Netherlands Antilles</option>
                					<option value="NC">New Caledonia</option>
                					<option value="NZ">New Zealand</option>
                					<option value="NI">Nicaragua</option>
                					<option value="NE">Niger</option>
                					<option value="NG">Nigeria</option>
                					<option value="NU">Niue</option>
                					<option value="NF">Norfolk Island</option>
                					<option value="MP">Northern Mariana Islands</option>
                					<option value="NO">Norway</option>
                					<option value="OM">Oman</option>
                					<option value="PK">Pakistan</option>
                					<option value="PW">Palau</option>
                					<option value="PS">Palestinian Territory</option>
                					<option value="PA">Panama</option>
                					<option value="PG">Papua New Guinea</option>
                					<option value="PY">Paraguay</option>
                					<option value="PE">Peru</option>
                					<option value="PH">Philippines</option>
                					<option value="PN">Pitcairn</option>
                					<option value="PL">Poland</option>
                					<option value="PT">Portugal</option>
                					<option value="PR">Puerto Rico</option>
                					<option value="QA">Qatar</option>
                					<option value="RE">Reunion</option>
                					<option value="RO">Romania</option>
                					<option value="RU">Russian Federation</option>
                					<option value="RW">Rwanda</option>
                					<option value="GS">S. Georgia and S. Sandwich Islands</option>
                					<option value="SH">Saint Helena</option>
                					<option value="KN">Saint Kitts and Nevis</option>
                					<option value="LC">Saint Lucia</option>
                					<option value="PM">Saint Pierre and Miquelon</option>
                					<option value="VC">Saint Vincent and the Grenadines</option>
                					<option value="WS">Samoa</option>
                					<option value="SM">San Marino</option>
                					<option value="ST">Sao Tome and Principe</option>
                					<option value="SA">Saudi Arabia</option>
                					<option value="SN">Senegal</option>
                					<option value="CS">Serbia and Montenegro</option>
                					<option value="SC">Seychelles</option>
                					<option value="SL">Sierra Leone</option>
                					<option value="SG">Singapore</option>
                					<option value="SX">Sint Maarten</option>
                					<option value="SK">Slovakia</option>
                					<option value="SI">Slovenia</option>
                					<option value="SB">Solomon Islands</option>
                					<option value="SO">Somalia</option>
                					<option value="ZA">South Africa</option>
                					<option value="ES">Spain</option>
                					<option value="LK">Sri Lanka</option>
                					<option value="SD">Sudan</option>
                					<option value="SR">Suriname</option>
                					<option value="SJ">Svalbard and Jan Mayen</option>
                					<option value="SZ">Swaziland</option>
                					<option value="SE">Sweden</option>
                					<option value="CH">Switzerland</option>
                					<option value="SY">Syria</option>
                					<option value="TW">Taiwan</option>
                					<option value="TJ">Tajikistan</option>
                					<option value="TZ">Tanzania</option>
                					<option value="TH">Thailand</option>
                					<option value="TL">Timor-Leste</option>
                					<option value="TG">Togo</option>
                					<option value="TK">Tokelau</option>
                					<option value="TO">Tonga</option>
                					<option value="TT">Trinidad and Tobago</option>
                					<option value="TN">Tunisia</option>
                					<option value="TR">Turkey</option>
                					<option value="TM">Turkmenistan</option>
                					<option value="TC">Turks and Caicos Islands</option>
                					<option value="TV">Tuvalu</option>
                					<option value="UG">Uganda</option>
                					<option value="UA">Ukraine</option>
                					<option value="AE">United Arab Emirates</option>
                					<option value="UK">United Kingdom</option>
                					<option value="US">United States</option>
                					<option value="UM">United States Minor Outlying Islands</option>
                					<option value="UY">Uruguay</option>
                					<option value="SU">USSR (former)</option>
                					<option value="UZ">Uzbekistan</option>
                					<option value="VU">Vanuatu</option>
                					<option value="VA">Vatican City State (Holy See)</option>
                					<option value="VE">Venezuela</option>
                					<option value="VN">Viet Nam</option>
                					<option value="VG">Virgin Islands (British)</option>
                					<option value="VI">Virgin Islands (U.S.)</option>
                					<option value="WF">Wallis and Futuna</option>
                					<option value="EH">Western Sahara</option>
                					<option value="YE">Yemen</option>
                					<option value="YU">Yugoslavia (former)</option>
                					<option value="ZR">Zaire (former)</option>
                					<option value="ZM">Zambia</option>
                					<option value="ZW">Zimbabwe</option>
                                </select>
                                <input type=hidden id=Country Name=Country value="" size="15">
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <div id=deladr></div>
                                    <input type=hidden Name=Address1 id=Address1 value="{address1}">
                                    <input type=hidden Name=Address2 id=Address2 value="{address2}">
                                    <input type=hidden Name=Address3 id=Address3 value="{address3}">
                                    <input type=hidden Name=Suburb id=Suburb value="{suburb}">
                                    <input type=hidden Name=State id=State value="{state}">
                                    <input type=hidden Name=PostCode id=PostCode value="{postcode}">
                                </td>
                            </tr>
                            <tr>
                                <td><input type="submit" name="btnSaveDelivery" value="{ButtonSaveDeliveryCaption}" onclick="javascript:return check_data();"></td>
                                <td><input type="submit" name="btnCancelDelivery" value="{ButtonCancelDeliveryCaption}" onclick="javascript:location.reload(); return false;"></td>
                            </tr>
                        </table>
                    </div>
                </td>
            </tr>
            <tr class="hide">
                <td class="DescriptionText">{DateCaption} </td>
                <td class="DescriptionText">{Date}</td>
            </tr>
            <!--PONumber-->
            <tr>
                <td class="DescriptionText">{PONumberCaption} </td>
                <td class="DescriptionText">{PONumber}</td>
            </tr>
            <!--/PONumber-->
            <tr>
                <td class="quantities-table" colspan="2"><b>Order Comments</b></td>
            </tr>
            <tr id="rowComments">
                <td width="100" class="DescriptionText">{CommentsCaption} </td>
                <td width="400" class="DescriptionText"><!--com--><TEXTAREA class=textboxtext rows=3 cols=25 name="Comments" id="Comments">{Comments}</TEXTAREA><!--/com--></td>
            </tr>
            <!--Urgent-->
            <tr>
                <td class="TextBoxText">{DeliveryCaption}</td>
                <td class="TextBoxText" valign="center"><!--ur--><Input type="checkbox" name="Urgent" onClick="ShowPrice(this)"{urgentcheck}><!--/ur-->&nbsp;</td>
            </tr>
            <!--/Urgent-->
            <!--PreApproval-->
            <tr>
                <td class="TextBoxText">{ApproversEmailCaption}</td>
                <td class="TextBoxText" valign="center">{PreApproval}&nbsp;</td>
            </tr>
            <!--/PreApproval-->
            <!--/OrderDetails-->
            <!--SaveAs-->
            <tr>
                <td class="TextBoxText">{ItemNameCaption}</td>
                <td class="TextBoxText" valign="center"><!--OrderName--><input type="text" name="txtSaveAs" value="{OrderName}" size="20" maxlength="200"><!--/OrderName--></td>
            </tr>
            <!--/SaveAs-->
        </table>
        <!--FileUpload-->
		<table class="table proofupload">
            <tr>
                <td colspan="2" align="left" class=bordertableheader>{FileAttachmentHeading}</td>
            </tr>
            <tr>
                <td class="TextBoxText">{FileUploadCaption}<br><a href="UploadAttachment.asp?tid={TemplateId}" id=hsfileattachment onclick="return hs.htmlExpand(this, { outlineType: 'rounded-white', wrapperClassName: 'highslide-wrapper', objectType: 'iframe', preserveContent: false, width:400} )" class="highslide">{LinkFileUploadCaption}</a></td>
            </tr>
            <tr>
                <td class="TextBoxText">
                    <span id=fileuploadspan>{uploadfilename}</span>
                    <input type=hidden name=fileupload id=fileupload value='{uploadfile}'>
                    <input type=hidden name=fileuploadname id=fileuploadname value='{uploadfilename}'>
                </td>
            </tr>
        </table>
        <!--/FileUpload-->
        <!--LIST-->
        <table class="table prooflist">
            <tr>
                <td colspan="2" style="padding: 0px">
                    <table class="wrapper" cellpadding="0" cellspacing="0" width="100%" id="Table1">
                        <tr>
                            <td class="bordertableheader">{ListHeading}</td>
                            <td class="bordertableheader">
                                <!--Write-->
                                <input type=button  value="{ButtonSelectDataCaption}" onclick="document.getElementById('ifListMan').src='VWebUploadList.aspx?{opssess}&TemplateId={TemplateId}&BC={BC}&ran=' + Math.random(); return hs.htmlExpand(this, { contentId: 'listselectupload', outlineType: 'rounded-white', outlineWhileAnimating: true } )" class="highslide">
                                <!--/Write-->
                            </td>
                        </tr>
                        <tr>
                            <td>{ListNameCaption}</td>
                            <td>
                                <input type="hidden" name="hidListId" id="hidListId" value="{listid}" /><span id="spnListName">{listname}</span>
                                <div class="highslide-html-content" id="listselectupload" style="width: 650px; height: 650px">
                                    <div style="height:20px; padding: 2px">
                                        <a href="#" onclick="return hs.close(this)" class="control">{HSCloseCaption}</a>
                                        <a href="#" onclick="return false" class="highslide-move control">{HSMoveCaption}</a>
                                    </div>
                                    <div class="highslide-body" style="padding: 0 5px 5px 5px;">
                                        <iframe src="" style="width:99%; height:450px" scrolling="no" frameborder="0" id="ifListMan"></iframe>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr><td colspan="2"><span id="spnPurchasePrice"></span></td></tr>
                        <tr><td colspan="2"><span id="spnListMappings" {HideMappings}></span></td></tr>
                        <tr><td colspan="2">&nbsp;</td></tr>
                    </table>
                </td>
            </tr>
            <!--SEEDS-->
            <tr>
                <td colspan="2" style="padding: 0px">
                    <table class="wrapper" cellpadding="0" cellspacing="0" width="100%" id="tabSeeds">
                        <tr>
                            <td class="bordertableheader">{SeedDataHeading}</td>
                            <td class="bordertableheader">
                                <!--Write-->
                                <input type=button  value="{ButtonUploadDataCaption}" onclick="document.getElementById('ifSeedListMan').src='VWebUploadList.aspx?{opssess}&TemplateId={TemplateId}&seed=1&ran=' + Math.random(); return hs.htmlExpand(this, { contentId: 'seedlistselectupload', outlineType: 'rounded-white', outlineWhileAnimating: true } )" class="highslide">
                                <div class="highslide-html-content" id="seedlistselectupload" style="width: 800px; height: 500px">
                                    <div style="height:20px; padding: 2px">
                                        <a href="#" onclick="return hs.close(this)" class="control">{HSCloseCaption}</a>
                                        <a href="#" onclick="return false" class="highslide-move control">{HSMoveCaption}</a>
                                    </div>
                                    <div class="highslide-body" style="padding: 0 5px 5px 5px;">
                                        <iframe src="" style="width:770px; height:470px" frameborder="0" id="ifSeedListMan"></iframe>
                                    </div>
                                </div>
                                <!--/Write-->
                            </td>
                        </tr>
                        <tr><td>Seed List</td><td><span id="spnseedlist">{seeds}</span><input type="hidden" name="hidSeedListId" id="hidSeedListId" value="{seedlistid}" /></td></tr>
                        <tr><td colspan="2"><span id="spnSeedListMappings" {HideSeedMappings}></span></td></tr>
                        <tr><td colspan="2">&nbsp;</td></tr>
                    </table>
                </td>
            </tr>
            <!--/SEEDS-->
            <!--RULES-->
            <tr>
                <td colspan="2" style="padding: 0px">
                    <table class="wrapper" cellpadding="0" cellspacing="0" width="100%" id="tabRules" style="display:none">
                        <tr>
                            <td class="bordertableheader">{RulesHeading}</td><td class="bordertableheader"><!--Write--><input type="button" name="btnRules" value="{ButtonRulesCaption}" onclick="getRules()"><a href="#" id="hsRules"></a><!--/Write--></td>
                        </tr>
                        <tr>
                            <td colspan="2" id="tdRules">{Rules}</td>
                        </tr>
                        <tr><td colspan="2">&nbsp;</td></tr>
                    </table>
                </td>
            </tr>
            <!--/RULES-->
            <!--MULTIDROP-->
            <tr>
                <td colspan="2" style="padding: 0px">
                    <table class="wrapper" cellpadding="0" cellspacing="0" width="100%" id="tabMultiDrop" style="display:none">
                        <tr>
                            <td class="bordertableheader">{DropsHeading}</td><td class="bordertableheader"><!--Write--><div id="divaddremdrops" style="display:none"><input type=button onclick="addDrop()" value="add drop"> <input type=button onclick="removeDrop()" value="remove drop"></div><!--/Write--></td>
                        </tr>
                        <tr>
                            <td colspan="2" id="tdmultidrop"></td>
                        </tr>
                        <tr><td colspan="2">&nbsp;</td></tr>
                    </table>
                </td>
            </tr>
            <!--/MULTIDROP-->
            <tr>
                <td colspan="2" style="padding: 0px">
                    <table class="wrapper" cellpadding="0" cellspacing="0" width="100%" id="tabproof" style="display:none">
                        <tr>
                            <td class="bordertableheader" colspan="2">{ProofVDHeading}</td>
                        </tr>
                        <tr><td colspan="2"><a href="javascript:showVariableProof()"><img src="images/pdf.gif" border=0>{LinkProofVDCaption}</a><a href="#" id="hsProof"></a></td></tr>
                        <tr><td colspan="2">&nbsp;</td></tr>
                    </table>
                </td>
            </tr>
        </table>
        <!--/LIST-->

<!--NexJobPricing-->
<script>
function UpdatePrice()
{
	if (document.getElementById('theCost'))document.getElementById('theCost').innerHTML = document.getElementById("NJPriceTag").innerHTML
}
</script>

<input type="hidden" id="TNJId" name="TNJId" value="{TemplateNexJobPageId}">
<input type="hidden" id="TNJCollection" name="TNJCollection" value="">
<input type="hidden" id="TNJPrice" name="TNJPrice" value="">
<input type="hidden" id="NJWeight" name="NJWeight" value="">
<input type="hidden" id="TNJQuantity" name="TNJQuantity" value="">
<input type="hidden" name="TNJVarQty" id="TNJVarQty" value="{NJVarQty}">
		<br>
		<TABLE width="100%" border="0" cellpadding="1" cellspacing="0" valign="top" class=bordertable>
			<!-- <TR>
			   <td align="left" class=bordertableheader>{NJOptionsHeading}</td>
			</tr> -->
			<tr>
			  <td class="TextBoxText">
				<div id="NJOptions"></div>
			  </td>
			</tr>
		</TABLE>
<!--/NexJobPricing-->
<script>
	LoadNexJob();
</script>
<!--Write-->
  <!--ApproveArtwork--><p>{ApproveArtworkText}</p><!--/ApproveArtwork-->
<!--/Write-->

            <input type="hidden" value="{TemplateId}" name="Template">
            <table border="0" align="bottom" width="100%">
              <tr>
                <td align="right">
                        <input type=hidden name="BC" value="{StatId}">
                        <!--HiddenVariables-->
                        <!--HiddenEVariables-->
                  <table border="0" width="100%" align="right">
                    <tr>
                      <td align="right" nowrap>
                      
<!--download-->
<!--downloadnow-->
  <a href="#" id="hrefdownload"></a><input type="button" onclick="download(document.getElementById('hrefdownload'), '', '', '');" value="{ButtonDownloadCaption}" />
	<div id="divdownload" class="highslide-html-content">
	  <h1>{DownloadHeading}</h1>
	  <div>
	    <!--downloadgenerated--><p><a href="javascript:download(this, 'pdf', '1', '{Order}');"><img src="images/ptr.gif" border="0" /> {LinkDownloadComposedCaption}</a></p><!--/downloadgenerated-->
	    <!--downloadgeneratedprogress--><p>{CompositionStatusCaption}: {vprintgeneratorstatus}</p><!--/downloadgeneratedprogress-->
	    <!--downloadhires--><p><a href="javascript:download(this, 'pdf', '', '');"><img src="images/ptr.gif" border="0" /> {LinkDownloadPrintReadyPDFCaption}</a></p><!--/downloadhires-->
	    <!--downloadlist--><span id="divdownloadlist" style="display:none"><p><a href="javascript:download(this, 'list', '', '');"><img src="images/ptr.gif" border="0" /> {LinkDownloadListCaption}</a></p>&nbsp;</span><!--/downloadlist-->
	    <p><input type="button" value="{ButtonCloseCaption}" onclick="hs.close()" /></p>
	  </div>
	</div>
<!--/downloadnow-->
<!--downloadlater-->
<!--Write--><input type="submit" name="btnDownload" id="btnDownload" value="{CartCaption}" onClick="javascript:blnOrder=false;return CheckApproveArtwork();"><!--/Write-->
<!--/downloadlater-->
<!--downloadonly-->
<table valign="top" class="bordertable"><tr><td class="DescriptionText">{DownloadOnlyCaption}
<input type=checkbox name="btnDownloadOnly" id="btnDownloadOnly" ></td></tr></table><br>
<!--/downloadonly-->
<!--/download-->


                    
					
<!--Write-->

<!--Variable--><input type="submit" name="btnVariable" id="btnVariable" value="{VariableCaption}"><!--CASS-->&nbsp;<input type="submit" name="btnCASS" value="Vertify Addresses >>"><!--/CASS--><!--/Variable-->
<!--VPrintCompose--><input type="submit" name="btnCompose" id="btnCompose" value="{ButtonVPrintComposeCaption}" onClick="javascript:blnOrder=false;" {showcompose}><!--/VPrintCompose-->
<!--Save--><input type="submit" class="btn btn-primary" name="btnSave" id="btnSave" value="{ButtonSaveCaption}" class="highslide" onClick="javascript:blnOrder=false; return CheckEmployeeLoggedIn(this);"><!--/Save-->
<!--VPrintProcessList--><input type="submit" name="btnProcessList" id="btnProcessList" value="{ButtonVPrintProcessListCaption}" onClick="javascript:blnOrder=false;" style="display:none"><!--/VPrintProcessList-->
<!--Order--><input type="submit" value="{ButtonOrderCaption}" name="btnOrder" id="btnOrder" onClick="javascript:blnOrder=true; return CheckApproveArtwork();"><!--/Order-->
<!--Cart--><input type="submit" class="btn btn-primary" name="btnCart" id="btnCart" value="{CartCaption}" onClick="return CheckSaveIntegrity();"><!--/Cart-->
<!--VWeb--><input type="submit" name="btnVWeb" id="btnVWeb" value="{CampaignCaption}"><!--/VWeb-->
<!--/Write-->

<div class="highslide-html-content" id="divLoginBox" style="width: 470px; height: 400px">
	<div style="height:20px; padding: 2px">
		<a href="#" onclick="return hs.close(this)" class="control">{HSCloseCaption}</a>
		<a href="#" onclick="return false" class="highslide-move control">{HSMoveCaption}</a>
	</div>
	<div class="highslide-body" style="padding: 0 5px 5px 5px;">
		<iframe src="" style="width:99%; height:95%" frameborder="0" id="ifLoginBox"></iframe>
	</div>
</div>                    
                      </TD>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
  </form>
<form method="post" name="frm2" id="frm2" target="_blank">
  <input type="hidden" name="mappings" id="mappings" value="" />
</form>
  <img src="images/spacer.gif" width="250" height="1" />